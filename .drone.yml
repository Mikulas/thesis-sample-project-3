kind: pipeline
name: default

steps:
- name: build-image
  image: plugins/docker
  settings:
    username: root
    password: CVUT_FIT
    tags: latest
    repo: registry.gitlab.ditemiku.local:4567/root/project-3
    registry: registry.gitlab.ditemiku.local:4567
    insecure: true

- name: deploy
  image: eeacms/rsync:1.2
  environment:
    SSH_KEY:
      from_secret: deploy-ssh-key
  commands:
  - mkdir -p /root/.ssh
  - echo "$SSH_KEY" | base64 -d > /root/.ssh/id_rsa
  - chmod go-rwx /root/.ssh/id_rsa
  - apk add --no-cache bash make
  - ssh -o StrictHostKeyChecking=no www-data@webserver-plain whoami
  - make deploy

volumes:
- name: site
  temp: {}

---
kind: secret

# cat src/cookbooks/ssh-ring/files/id_rsa | base64 | xargs drone encrypt root/project-3
data:
  deploy-ssh-key: gkwHrO89QbcsSunNA3lOCyfGOefv6GvpHnnIpL_2GWefIASEV2ubiiwWDvYiJsHRCrVJ9YuCCVlcVzXzJKPJoWCGejdfYuVxg648O_PADx6DoHyTIde2OaFYuvpD_coEAU5hQvPGpSRVbF2YmhAvTk8YIKIh353lZIqZTsT9fkNbl0_8YFoh93PKZqyLf9M6eiYPvSLbl3plQYTnbg7kfQKurPjxY7ha3xoqcnutE02hGLPUiFU0Q6KojwqZuf2A4DgeeXKI-H5HejF9oMC7bbzofi0h9l-BFpoAmFQVX8r6wkns1_q8dpwDT3RJVS1J9avyuS5kfr8fymmgMA1N3WeEpkvvPoYRQ6FqFLFXo6WK5td7bY7PS4KjN9-KV_T5JMD0oAyAf3hhi6rcAnO6xS2fnAuKZNRiYs9qbh-eLCRzgdHcxn-4UOTRLw4xko5Z8BfcZtKf2upDTQAT2jDWLl7P7nDFAcAJ_g28aS3AeeexhxY0A-jC7LIigizA6ltFea09yzwFmGYqBeV52fHry3D22NQLdScctxoR3trDM9E4qYEbYwfpgu57cKnUPxc3I8wUKCD7VrhG779hl-ZRbp20gZ8uSa0NhxMYlL9v9zSkXB9jjTb96DrOzZZRmb6eIfh6QbZn-ZNu_c6G_l-1rc4iK88pYKPu1MPHfN7aeNsSSunU-YjztEzkXx3qc3iu0rvp_RxUhp7DsNBKI0uFtu3uYLskrpvbFd826xlmjptX9edHGGzbYuOeEmQCEDY4x3TnCPXFCa-LmbiWD9zR7XWCyqOIp9RwqySB-rSklZdoUk-ZDwCBgw9afp3FxSM2QzaVU_rVbnHARfTkB54rms-ahIrG-Yp9G7r3bwZ6lUO4SfuRbVPxKC5BdX7gxLUca0dXdcun02VaQgT5G0_gMT3Flx4uDomHs1wEjBgFsC2wN1Vt_flpzgXiWniDClxNUQl9Z6RkV06GvXoSkzBH-AzBaePImK7JT54101ZhxF1O8zG_F87Pt3Wnw9R0fibtfUBTKjnxUIf-stcjRNs8AiHAyr3klhOn-bJQSToHlemGMWXjp8ImMG6C225oxe482yGLbPbYUW5UrFRCFXA8s1VsGVms3zHSDtL0u7kXjmaRIhr5UnelGIoFCFGHHZyjJDt1cIvkF9a2_RufkrOBW2kITg32bsF1roBCaWHo6CDhSmNjiAv1xnbCEtX5wGY_zf0aEnq9dReVdK_nju9Fbx2XOYGJ_jxrIzCmjldq9ycxaLL6C-44-D_Q6QQzpThM29YFezlsmczAf9IoHMQM_Q_EDMs2aVTL4U9a9P5dLn-A4J9hG5Dzv0ekuV7Hm-BTVKo4FBdMaPGaV5SjImuixCuUDioguXQ-aXKQ8FLLbjwuQlE2hgEF6xI5y-qRc1_FuldqEoEjJ7MEhbagJN8gbq5YAe-eBgmFU4323ww0eN8-4sa8fdXKy9F7mIdDVEIZNMLbrl9QT_kdiO_ep6YrUz_FLsx83-dC2XzJ6usBj27jHIV9_GHlKyZLfzbHtlULRWX__MmZQtA0Lfq791A_xB97aSJWWBr6gYf1oidFbtPi4pJdh6kJy6YN1X--6bekOjApZmHgNWHDaTz7ZR8nHjy2_W5DdK1xg-JC1juaMALwEbUi7ler0R6pJOAk4c0a6RvC_GKncotysxh_z6pdDzLwDxL8vDWTrLWLcTevFQNmvfn_R0T1uNyd3vsIDJY9v6CAUjhNOsoxW34peHct7vvn_DAiDyDDsTV-uyRzoNBiC-7VGGa6e4hM9ubCPJmOTq74fxv4fuzogRFsUAWMj_gq86oHQctnnBlA5dB5YRLDPbjj7jwQ1xYUKxbxUPOqWcARc1fu_9Qll6i5EtD9x0y9oKJi6qaH7D2_0fEw-eYnfXtxgjW_uNkLnuPgHsqsxkka-oA1-BdcLJd44JQZgkzoPcmBvrnIHEl_Sn_NKq1uxZfvXoYVZHGy1Jjou337GcF5HIyNMqFTNfiK8gQs_vDvGa35lK08IznblXyq26Xf5IQMU4FsHkk_xKl1DxJH27Y-zce0Jl7sNHp6WuWMCZnvvaa55pFZqZs6S82nUGuyc-_sbwMb7xCehc5VWjgcOGtZImBOJaq-9qYinPbdEAIspLfKJZchlYxarrETTIqHskvWlg3O3UAxJ9fhJJRCT37GXp66AY0Xe6gVxYLdcGzi2PWNNlllZuxNbjmhL7vWQ8HPMS0CDcAa4fIssGOEdy_vOWbX4IDrVyjYBdAC73Pah4p50bheKX6Qy9j7tTcTswMPMCeXsGtI8F6_ISEaS8hg97moEgdv9tM47ymiJjClpW15vP_cwlTZCXgeqoRTFkzzVBhImdHvX1U2IkWhXlTUTljuG5utMLh3Z7D3aQOEuFNFkdyGlTUKtxTvjugbjk3kasWimtH-c5s0uLiIOlnl0QCNpHCZZr-nz0pSFMKeY0a-my1-07hfmBjzMZ9wxhheumpdrpZ1sS8NaNP_HnIYXaRiyB1-OkkxU04mlluJDY7Z851R3OrzU7XTv8pCwQhwxZGbt9kogIGP_mTla5kdv6VTUhnk2ArMuklQaipemsfEkiwE2dTH_XpZboCFU0Fi5Y5wUsLfb_HhcHfVWPaNLga1j3xMX83bAM9nnV368XuQmn3rPARaMrTZfqzd_iJUHq4P9L5XrFOTbuKReU9yCA71divD8DFFON42w3ZS4PPEgyW6t-r9PwtypKEjgkUrZSokd_ackVUcd_usiGk0alBZFzst0q1-CQYtdAUO1A7tW5ZfTo_m97Ul-N-tLvBvdLKarUVJNM1ez5Gu706qybkTglPNRf27A6ccD1nSF75euGiuqGkwkbtIz15zghxQd1h0nGX9X7DliToaWP9AvJvFLHT0rUR8dj-4k7XOPWyOsr44Y2opP8BpJESljqNLtSi-6FWB1UV4d3RYnIZnB4y6TUU-6xNOfjvg-emlFT-XJKDGg8kVslR1Paq2zgxkKiPd_s6pCsSVVrw2Kr_dcS7AkUdFlIIMrX1gDY8tmGFojXO6ZUtl3MXnC19clPXsdkAqc6qO5VrEpeIcnVpu0A0PfQiCF5c5a1FoTvi3av5p7nvYsoMQqHLOJwoJydnp5L6PcanY6l7f1pF-JUmcV9jpM-DICRKN7BkaznDBFI_81xdDPHrABIInYq_vyFUvnZVLdHZq5uhn0fc6v2MRSzQhnAGNyGBPXnjbMTHwlODZ2asPBJQA3gonf8tAHvv-0CbW1irZNeMWbKsDK3g8L2FRBydTK4proouu-tCekO1R-2fGlti_PwbGPjwDRw201ZeEkPj2k9Gn4bNp8e3zwOKVow2u99rjRdzTpi3wRy9MXaZKBEvl_yopkySsiaWneItmNqn49RDkgLTB5WZwBQ6a_kwyeS1s36BxHG2foJbJb55QrSmRIRgOwyYs_yHtBk99nqc2WAcKx3q9r-orSY-K2g5aubNCBczS2lYGLd1UTisxqKgxsxbCDcb2Hv0Z7kTRUBw_-HbCbWebAR-Dlq342O7UfLUEGFGzYxq31FM3I_30Kt2QLKgegPraz7Ggq1_NkFve7aEjoRiL_Gcu4uIzmgCSoO44WZ4rnG1cUUgh5gM2sj_0ieYKE8M9Wcp6EROIw_oPlQr-CDT6O1WavAe9EXxxzFCNR1ndG5CFf5xcLnaYuTNe9iQaYhG_m-kYwmstJ9vIZD9eyd2bDvb_xx-RxXO9BpRlsQhkvp7yBU-ubhbKnHvc7gr5kjufj8ka8it5Bm80QqMLa8gd54vfhZDo_NWr0avqAgSinPuRTHv2sHqNqGuIrCeAewiaMeR63cM3be_0TjYSl65QFF840FG_hO8F_I6H4T7g0f8pe86H3gFgICAVH1FEWYPfeuZhDvEaofkdXKwLkdB6rmOC-V3NwaHywe1tY7ZjDhh4iMPL-l6q10n-n8z5_HVDzWk8fisHyB-8MidCbFKFXjjNNPWfUu6AgDvsFj-r9sWU_a_sZKWgv-28qbTlmiFOx9qg4MH-LYzWa8oiilsuwtvumaxnQTLEw7Vzfknn5hea30JBfpm68287Bl3gwlMIGxH42rM60EKZtj1y9gdwg6cuRW3hMizoC1Casm9X44t7z_42ZZqJImy_0S1240VBdekP95dcDzpjHZ9bX_nVwNnyoommHvk_IkmbTVl8ciT28TPKIo4P5FR7RE65bIaQhrj0x7MaaXR8PSZOBwoHsNGmBvTWci06QVgwK2CdDLqyaTXaQ8x_pxePY-X1GMi_cBGHmdMNTDMosblGXCfzhpAWQnWUDLvZmQDU2Dnkr0q9q0mx1SzA5T5G3wRBCvvVYUnukbDWPO9T1t70EysDfmapJsPRiSeJ3qfGP2XyVn5Ik_jlGwYG9tSoPV5y72RyiYk0vCXeDiPiWvgN0oL2YIIERmzv0cymT3ZT0_Mv3sSf6L0ZMuIgnOgkTT6sAf3jgs-1MOP8LaqNm2ZWm9nrIQ8FeVuU-wBB0JHCG13h3PHbv6GoWxomNb3zEG42lHFFuBChEvEr3NrICFNGr_J7AAfkgtr0mZI8lgR2dzZn_b2bOaTfePMTRbsV5u7qeDer-VQ65p4AhI8OPwJKQQvcTOR5HrHwgTIDLeKSjCQoScSgJXzewyTvl93cEVgQzZutzrjy_4N53aHmY8sAf7NhGvYQT80oD8h1ca8LhvwwshA8pmEU1fAK1hPvjfidBhtLdOTSOpqlaszfatrBLszNJJbUGIISsJGlvY_zb6GMMrKKecGSpS8BBxJAwDpb9puzOonmk2vk2xRQz_lqC5bzztM5rYtiMAUyITlAe1lUYB8mIH0Js_EcjrIYQ6fTj9V7vGQ5o3KUZXg0bSn_ptmXF9xSi18dqmf-ryr0qk4mi5nKXPBDXKeeI2ACI8FkpJfnDWRk12vvK-U85FlyQqgM1UGHxBHCQPFpJGRzVhK0kYxlB37H2cY5sQa5bMhOt7pokHcPd7vUObiNsF_0FCxshYAaz8S0RF-lnmHjEHgSYrPJy74RFn139HMH8DOqlcWW8L2VcpIFZxZztYGOVsOkdHTglswg7wnUXi8Hh7my8mEWzvirtcojNK1Njcw4EvoZ0HbJa3nt7xe81nVwRDR-zS-THbWHZ0wcIr7r1Oy-E4ENJP3I9Rrrg1m3pJzizymINiPJX5R6jfqzUBTPEeNYTtRf7ZLg_ZcWxZIFIbPi5A3AZji1emjR4Xf7QL3RwSKOfek5T0pBnEULiqUgtU5ToOpY6CC0WFjC-P4GogwCOEQ7yFLBBNAE5d73Rma0KK0wMilXudyXRPZ5M_LopfWRuUAngkvSFFBHNV-nQRIfGzuMjqCZ0g1WDtZel-D1Vi1h3uKIsZ_4L9FEb4mViyZ-Q7xknrCa6yG59IWwaS9xlGZ0hSVyPDJtJEyy_82QBK9ti-FgjNKcJgYcdYaLSfyrt4IrdnOOu5zjvHl4-7yWFP3tkczCBeAqtvP3tLvOqK766HQh2Biu-9zWaHT1GdJ0hGCibsUYnDwXlt6GdAar_AftRnAbrcsgf-RShKOzK8n9VjHV_iJkgA3RE7TLwhTfYaiZRNzsUhdFgsXVHyVheFCBDxTP1rZnEzt-lgJZQuAaaQyZTcdtUwnJbaCqiuVo6wu0dbyxjFvlb85Dc76W-TS6ZN85lb9P_ywFmYQ_jffx3qMLQvRE-eKuvXmL_S0ETTPgLYUiMmiSxQxktkoJuZmARIIi0FHlr6tWH08d5d6wC-Td47r2r5PC0eJQ6ndaCgVuMpFSyv5xduy8mvLwISb3WF2o17OhVlSxZCxmMSUjD8CuMUEh5eQyjN6yLLNUB0zX_3IsVadoxxOse9mSx3SP8f2OZamOKqz6oPZdNe6pNVvvVnduR-38NOlim1Cs0Ghet_Fb5HS7moB_yonXudvgQAd12DZvSLuTNYUbgcgknuIUaVrGMpDmG3yZ98ZwwY1yDWC1BtRdsZTc4KpzZKlu4i5C0rp4k1M8FsCi_QHXrGgst-VeO0oQzKzpOBh4bvwRuO4VuZ0lqQk5voZFijeS_CB0S_DAworUbNy3XuVN3NwmdoSJnYLIoY__zXg=
